name: Deploy Static Website to S3

on:
  push:
    branches:
      - main  # Trigger deployment on push to the main branch

jobs:
  deploy:
    runs-on: ubuntu-latest  # Use the latest Ubuntu runner

    steps:
      # Step 1: Checkout the code
      - name: Checkout code
        uses: actions/checkout@v2

      # Step 2: Set up AWS CLI using OIDC
      - name: Set up AWS CLI
        uses: aws-actions/configure-aws-credentials@v1
        with:
          role-to-assume: arn:aws:iam::248189921392:role/GITHUB_OIDC  # The ARN of your IAM role (role name provided by you)
          aws-region: ${{ secrets.AWS_REGION }}  # The AWS region where the bucket is located (store region in GitHub secrets)

      # Step 3: Sync files to S3 bucket
      - name: Sync files to S3 bucket
        run: |
          aws s3 sync ./ s3://vision-ads --delete --exclude ".git/*"  # Sync files to your S3 bucket 'vision-ads'

     
